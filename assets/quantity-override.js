class QuantityOverride{constructor(){this.init()}init(){this.interceptFormSubmissions(),this.interceptFetchCalls(),this.watchAddToCartButtons(),this.watchCartItems(),this.observeDOM(),this.ensureRemoveButtonsAreVisible(),document.addEventListener("DOMContentLoaded",()=>{this.ensureRemoveButtonsAreVisible()})}interceptFormSubmissions(){document.addEventListener("submit",e=>{var e=e.target;e.action&&e.action.includes("/cart/add")&&(e=e.querySelector('input[name="quantity"]'))&&(e.value="1",console.log("Formular-Übermittlung abgefangen, Menge auf 1 gesetzt"))},!0)}interceptFetchCalls(){let a=window.fetch;window.fetch=async function(e){var t,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(e&&"string"==typeof e&&e.includes("/cart/add"))try{if(r.body){if(r.body instanceof FormData){var o,n,i=new FormData;for([o,n]of r.body.entries())"quantity"===o?i.append(o,"1"):i.append(o,n);r.body=i}else if("string"==typeof r.body)try{(t=JSON.parse(r.body)).quantity&&(t.quantity=1,r.body=JSON.stringify(t))}catch(e){r.body.includes("quantity=")&&(r.body=r.body.replace(/quantity=\d+/,"quantity=1"))}console.log("Fetch-Aufruf zum Warenkorb abgefangen, Menge auf 1 gesetzt")}}catch(e){console.error("Fehler beim Interceptieren des fetch-Aufrufs:",e)}return a(e,r)}}watchAddToCartButtons(){document.addEventListener("click",e=>{var e=e.target.closest("[data-add-to-cart]");e&&(e=e.closest("form"))&&(e=e.querySelector('input[name="quantity"]'))&&(e.value="1",console.log("Add to Cart Button abgefangen, Menge auf 1 gesetzt"))})}watchCartItems(){document.addEventListener("DOMContentLoaded",()=>{this.resetCartItemsQuantity(),this.ensureRemoveButtonsAreVisible()})}resetCartItemsQuantity(){var e=document.querySelectorAll(".cart-item");0<e.length&&e.forEach(e=>{var t,e=e.querySelector('input[name^="updates"]');e&&"1"!==e.value&&(e.value="1",t=new Event("change",{bubbles:!0}),e.dispatchEvent(t),console.log("Warenkorbelement-Menge auf 1 zurückgesetzt"))})}ensureRemoveButtonsAreVisible(){console.log("Stelle sicher, dass Remove-Buttons sichtbar sind");var e=document.querySelectorAll('cart-remove-button, [id^="CartDrawer-Remove"]');0<e.length?(e.forEach(e=>{e.style.setProperty("display","flex","important"),e.style.setProperty("visibility","visible","important"),e.style.setProperty("opacity","1","important"),e.style.setProperty("position","absolute","important"),e.style.setProperty("z-index","999","important"),e.style.setProperty("pointer-events","auto","important");var t=e.querySelector("button");t&&(t.style.setProperty("display","flex","important"),t.style.setProperty("visibility","visible","important"),t.style.setProperty("opacity","1","important"),t.style.setProperty("pointer-events","auto","important"));let r=e.parentElement;for(;r&&(r.matches(".cart-item__quantity-wrapper")||r.matches(".quantity-popover-wrapper")||r.matches("quantity-popover")||r.matches(".cart-item__quantity"));)r.style.setProperty("display","flex","important"),r.style.setProperty("visibility","visible","important"),r.style.setProperty("opacity","1","important"),r=r.parentElement}),console.log(e.length+" Remove-Buttons sichtbar gemacht")):console.log("Keine Remove-Buttons gefunden")}observeDOM(){new MutationObserver(e=>{for(var t of e)"childList"===t.type&&0<t.addedNodes.length&&t.addedNodes.forEach(e=>{var t;e.nodeType===Node.ELEMENT_NODE&&((0<(e.querySelectorAll?e.querySelectorAll(".cart-item"):[]).length||e.classList&&e.classList.contains("cart-item"))&&(this.resetCartItemsQuantity(),this.ensureRemoveButtonsAreVisible()),0<(t=e.querySelectorAll?e.querySelectorAll('form[action*="/cart/add"]'):[]).length&&t.forEach(e=>{e=e.querySelector('input[name="quantity"]');e&&(e.value="1")}),0<(e.querySelectorAll?e.querySelectorAll('cart-remove-button, [id^="CartDrawer-Remove"]'):[]).length)&&this.ensureRemoveButtonsAreVisible()})}).observe(document.body,{childList:!0,subtree:!0})}}document.addEventListener("DOMContentLoaded",()=>{window.quantityOverride=new QuantityOverride}),window.quantityOverride=new QuantityOverride;